<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Structural Equation Modeling with Latent Variables using R</title>
  <meta name="description" content="Structural Equation Modeling with Latent Variables using R" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="Structural Equation Modeling with Latent Variables using R" />
  <meta property="og:type" content="book" />





  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Structural Equation Modeling with Latent Variables using R" />




<meta name="author" content="Muhammad Yaseen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />



<link rel="next" href="MLM.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="LM.html"><a href="LM.html"><i class="fa fa-check"></i><b>1</b> Linear Model</a><ul>
<li class="chapter" data-level="1.1" data-path="LM.html"><a href="LM.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="LM.html"><a href="LM.html#linear-modeling-approach"><i class="fa fa-check"></i><b>1.2</b> Linear Modeling Approach</a></li>
<li class="chapter" data-level="1.3" data-path="LM.html"><a href="LM.html#strucural-equation-modeling-approach"><i class="fa fa-check"></i><b>1.3</b> Strucural Equation Modeling Approach</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="MLM.html"><a href="MLM.html"><i class="fa fa-check"></i><b>2</b> Multivariate Linear Model</a><ul>
<li class="chapter" data-level="2.1" data-path="MLM.html"><a href="MLM.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SEMO.html"><a href="SEMO.html"><i class="fa fa-check"></i><b>3</b> Structural Equation Modeling with Observed Variables</a><ul>
<li class="chapter" data-level="3.1" data-path="SEMO.html"><a href="SEMO.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="FA.html"><a href="FA.html"><i class="fa fa-check"></i><b>4</b> Factor Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="FA.html"><a href="FA.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SEM.html"><a href="SEM.html"><i class="fa fa-check"></i><b>5</b> Strucural Equation Modeling with Latent Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="SEM.html"><a href="SEM.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/baydap/bookdownplus/" target="blank">Supported by bookdownplus</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Equation Modeling with Latent Variables using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Structural Equation Modeling with Latent Variables using R</h1>
<p class="author"><em>Muhammad Yaseen</em></p>
</div>
<div id="LM" class="section level1">
<h1><span class="header-section-number">1</span> Linear Model</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>The model relating the normal dependent variable <span class="math inline">\(Y\)</span> with the explanatory variables <span class="math inline">\(X_1, X_2, \cdots, X_q\)</span> is</p>
<p><span class="math display">\[\begin{align}
Y &amp; = \gamma_{1}X_{1}+\gamma_{2}X_{2}+\cdots+\gamma_{q}X_{q}+\epsilon \label{eq:LM1}\\
Y &amp; =\mathbf{x}^{\prime}\bm{\alpha}+\epsilon=\bm{\alpha}^{\prime}\mathbf{x}+\epsilon \label{eq:LM2}
\end{align}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:LM1"></span>
<img src="images/LM1.png" alt="Path Diagram of Linear Model" width="80%" />
<p class="caption">
Figure 1.1: Path Diagram of Linear Model
</p>
</div>

</div>
<div id="linear-modeling-approach" class="section level2">
<h2><span class="header-section-number">1.2</span> Linear Modeling Approach</h2>
<p>Linear Model (LM) can only measure direct effects
</p>

<div class="figure" style="text-align: center"><span id="fig:Reg1"></span>
<img src="images/Reg1.png" alt="Path Diagram of Regression" width="80%" />
<p class="caption">
Figure 1.2: Path Diagram of Regression
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;Income.RData&quot;</span>)
<span class="co"># Income</span>
<span class="kw">str</span>(Income)</code></pre>
<pre><code>&#39;data.frame&#39;:   25 obs. of  5 variables:
 $ Income         : num  40.3 39.6 40.8 40.3 40 38.1 40.4 40.7 40.8 37.1 ...
 $ Value          : int  180 121 161 161 179 99 114 202 184 90 ...
 $ Education      : int  14 15 14 14 14 14 15 14 13 14 ...
 $ Age            : int  53 49 44 39 53 46 42 49 37 43 ...
 $ MortgagePayment: int  230 370 397 181 387 304 285 551 370 135 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Income.lm.fm1 &lt;-
<span class="st">  </span><span class="kw">lm</span>(
      <span class="dt">formula    =</span> Income <span class="op">~</span><span class="st"> </span>Value <span class="op">+</span><span class="st"> </span>Education <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span>
<span class="st">                            </span>MortgagePayment
    , <span class="dt">data       =</span> Income
  <span class="co"># , subset</span>
  <span class="co"># , weights</span>
  <span class="co"># , na.action</span>
    , <span class="dt">method      =</span> <span class="st">&quot;qr&quot;</span>
    , <span class="dt">model       =</span> <span class="ot">TRUE</span>
    , <span class="dt">x           =</span> <span class="ot">FALSE</span>
    , <span class="dt">y           =</span> <span class="ot">FALSE</span>
    , <span class="dt">qr          =</span> <span class="ot">TRUE</span>
    , <span class="dt">singular.ok =</span> <span class="ot">TRUE</span>
    , <span class="dt">contrasts   =</span> <span class="ot">NULL</span>
  <span class="co"># , offset</span>
  <span class="co"># , ...</span>
  )

<span class="kw">summary</span>(Income.lm.fm1)</code></pre>
<pre><code>
Call:
lm(formula = Income ~ Value + Education + Age + MortgagePayment,
    data = Income, method = &quot;qr&quot;, model = TRUE, x = FALSE, y = FALSE,
    qr = TRUE, singular.ok = TRUE, contrasts = NULL)

Residuals:
     Min       1Q   Median       3Q      Max
-1.05615 -0.37792 -0.05208  0.47685  1.20372

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     28.438187   3.442601   8.261 7.08e-08 ***
Value            0.032302   0.005712   5.656 1.55e-05 ***
Education        0.607859   0.277795   2.188   0.0407 *
Age             -0.037207   0.035780  -1.040   0.3108
MortgagePayment -0.001345   0.001449  -0.928   0.3644
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.685 on 20 degrees of freedom
Multiple R-squared:  0.6463,    Adjusted R-squared:  0.5756
F-statistic: 9.137 on 4 and 20 DF,  p-value: 0.0002286</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Income.lm.fm1)<span class="op">$</span>coef</code></pre>
<pre><code>                    Estimate  Std. Error    t value     Pr(&gt;|t|)
(Intercept)     28.438187019 3.442600555  8.2606700 7.077863e-08
Value            0.032301977 0.005711513  5.6555905 1.553422e-05
Education        0.607858710 0.277794920  2.1881563 4.069801e-02
Age             -0.037207429 0.035780364 -1.0398840 3.108026e-01
MortgagePayment -0.001345319 0.001449331 -0.9282344 3.643539e-01</code></pre>
<div class="figure" style="text-align: center"><span id="fig:Reg1Values"></span>
<img src="images/Reg1Values.png" alt="Path Diagram of Regression with estimates of coefficient obtained from \emph{lm}" width="80%" />
<p class="caption">
Figure 1.3: Path Diagram of Regression with estimates of coefficient obtained from
</p>
</div>
</div>
<div id="strucural-equation-modeling-approach" class="section level2">
<h2><span class="header-section-number">1.3</span> Strucural Equation Modeling Approach</h2>
<p>Strucural Equation Model (SEM) can measure direct as well as indirect effects</p>


<div class="figure" style="text-align: center"><span id="fig:RegSEM1"></span>
<img src="images/RegSEM1.png" alt="Path Diagram of Regression" width="80%" />
<p class="caption">
Figure 1.4: Path Diagram of Regression
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lavaan)

Income.sem.m1 &lt;-<span class="st"> &#39;</span>
<span class="st">  # Regressions</span>
<span class="st">    Income ~ gamma1 * Value + gamma2 * Education +</span>
<span class="st">             gamma3 * Age   + gamma4 * MortgagePayment</span>
<span class="st">&#39;</span>

Income.sem.fm1 &lt;-
<span class="st">  </span>lavaan<span class="op">::</span><span class="kw">sem</span>(
      <span class="dt">model            =</span> Income.sem.m1
    , <span class="dt">data             =</span> Income
    , <span class="dt">ordered          =</span> <span class="ot">NULL</span>
    , <span class="dt">sampling.weights =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.cov       =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.mean      =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.nobs      =</span> <span class="ot">NULL</span>
    , <span class="dt">group            =</span> <span class="ot">NULL</span>
    , <span class="dt">cluster          =</span> <span class="ot">NULL</span>
  <span class="co"># , constraints      = &quot;&quot;</span>
    , <span class="dt">WLS.V            =</span> <span class="ot">NULL</span>
    , <span class="dt">NACOV            =</span> <span class="ot">NULL</span>
  <span class="co"># ,   ...</span>
  )

<span class="co"># anova(Income.sem.fm1)</span>
<span class="co"># coef(Income.sem.fm1)</span>
<span class="kw">parameterEstimates</span>(Income.sem.fm1, <span class="dt">standardized =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>               lhs op             rhs  label       est    se
1           Income  ~           Value gamma1     0.032 0.005
2           Income  ~       Education gamma2     0.608 0.248
3           Income  ~             Age gamma3    -0.037 0.032
4           Income  ~ MortgagePayment gamma4    -0.001 0.001
5           Income ~~          Income            0.375 0.106
6            Value ~~           Value          773.526 0.000
7            Value ~~       Education           -2.619 0.000
8            Value ~~             Age           30.408 0.000
9            Value ~~ MortgagePayment         1087.181 0.000
10       Education ~~       Education            0.458 0.000
11       Education ~~             Age            2.216 0.000
12       Education ~~ MortgagePayment          -14.822 0.000
13             Age ~~             Age           27.840 0.000
14             Age ~~ MortgagePayment          -18.584 0.000
15 MortgagePayment ~~ MortgagePayment        10739.898 0.000
        z pvalue  ci.lower  ci.upper    std.lv std.all   std.nox
1   6.323  0.000     0.022     0.042     0.032   0.872     0.031
2   2.446  0.014     0.121     1.095     0.608   0.399     0.590
3  -1.163  0.245    -0.100     0.026    -0.037  -0.191    -0.036
4  -1.038  0.299    -0.004     0.001    -0.001  -0.135    -0.001
5   3.536  0.000     0.167     0.583     0.375   0.354     0.354
6      NA     NA   773.526   773.526   773.526   1.000   773.526
7      NA     NA    -2.619    -2.619    -2.619  -0.139    -2.619
8      NA     NA    30.408    30.408    30.408   0.207    30.408
9      NA     NA  1087.181  1087.181  1087.181   0.377  1087.181
10     NA     NA     0.458     0.458     0.458   1.000     0.458
11     NA     NA     2.216     2.216     2.216   0.621     2.216
12     NA     NA   -14.822   -14.822   -14.822  -0.211   -14.822
13     NA     NA    27.840    27.840    27.840   1.000    27.840
14     NA     NA   -18.584   -18.584   -18.584  -0.034   -18.584
15     NA     NA 10739.898 10739.898 10739.898   1.000 10739.898</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fitmeasures(Income.sem.fm1)</span>
<span class="kw">fitted</span>(Income.sem.fm1)<span class="op">$</span>cov</code></pre>
<pre><code>                Income    Value     Eductn    Age
Income              1.061
Value              20.800   773.526
Education           0.131    -2.619     0.458
Age                 1.318    30.408     2.216    27.840
MortgagePayment    12.351  1087.181   -14.822   -18.584
                MrtggP
Income
Value
Education
Age
MortgagePayment 10739.898</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># residuals(Income.sem.fm1, type = &quot;cor&quot;)</span>
<span class="co"># modificationIndices(Income.sem.fm1)</span>
<span class="kw">var</span>(Income)</code></pre>
<pre><code>                   Income       Value   Education        Age
Income           1.105433   21.667000   0.1365000   1.373333
Value           21.667000  805.756667  -2.7283333  31.675000
Education        0.136500   -2.728333   0.4766667   2.308333
Age              1.373333   31.675000   2.3083333  29.000000
MortgagePayment 12.865667 1132.480000 -15.4400000 -19.358333
                MortgagePayment
Income                 12.86567
Value                1132.48000
Education             -15.44000
Age                   -19.35833
MortgagePayment     11187.39333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Income)</code></pre>
<pre><code>                   Income      Value  Education         Age
Income          1.0000000  0.7259899  0.1880438  0.24255525
Value           0.7259899  1.0000000 -0.1392157  0.20721237
Education       0.1880438 -0.1392157  1.0000000  0.62085779
Age             0.2425553  0.2072124  0.6208578  1.00000000
MortgagePayment 0.1156915  0.3771934 -0.2114343 -0.03398635
                MortgagePayment
Income               0.11569153
Value                0.37719344
Education           -0.21143430
Age                 -0.03398635
MortgagePayment      1.00000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># vcov(Income.sem.fm1)</span>


<span class="kw">summary</span>(
    <span class="dt">object       =</span> Income.sem.fm1
  , <span class="dt">header       =</span> <span class="ot">TRUE</span>
  , <span class="dt">fit.measures =</span> <span class="ot">FALSE</span>
  , <span class="dt">estimates    =</span> <span class="ot">TRUE</span>
  , <span class="dt">ci           =</span> <span class="ot">FALSE</span>
  , <span class="dt">fmi          =</span> <span class="ot">FALSE</span>
  , <span class="dt">standardized =</span> <span class="ot">TRUE</span>
  , <span class="dt">rsquare      =</span> <span class="ot">TRUE</span>
  , <span class="dt">std.nox      =</span> <span class="ot">FALSE</span>
  , <span class="dt">modindices   =</span> <span class="ot">FALSE</span>
  , <span class="dt">nd           =</span> 3L
)</code></pre>
<pre><code>lavaan 0.6-3 ended normally after 20 iterations

  Optimization method                           NLMINB
  Number of free parameters                          5

  Number of observations                            25

  Estimator                                         ML
  Model Fit Test Statistic                       0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Information                                 Expected
  Information saturated (h1) model          Structured
  Standard Errors                             Standard

Regressions:
                   Estimate   Std.Err  z-value  P(&gt;|z|)
  Income ~
    Value   (gmm1)     0.032    0.005    6.323    0.000
    Educatn (gmm2)     0.608    0.248    2.446    0.014
    Age     (gmm3)    -0.037    0.032   -1.163    0.245
    MrtggPy (gmm4)    -0.001    0.001   -1.038    0.299
   Std.lv   Std.all

     0.032    0.872
     0.608    0.399
    -0.037   -0.191
    -0.001   -0.135

Variances:
                   Estimate   Std.Err  z-value  P(&gt;|z|)
   .Income             0.375    0.106    3.536    0.000
   Std.lv   Std.all
     0.375    0.354

R-Square:
                   Estimate
    Income             0.646</code></pre>
<div class="figure" style="text-align: center"><span id="fig:RegSEM1Values"></span>
<img src="images/RegSEM1Values.png" alt="Path Diagram of Regression with estimates of coefficient obtained from \emph{sem}" width="80%" />
<p class="caption">
Figure 1.5: Path Diagram of Regression with estimates of coefficient obtained from
</p>
</div>


<div class="figure" style="text-align: center"><span id="fig:Reg2"></span>
<img src="images/Reg2.png" alt="Path Diagram of Regression" width="80%" />
<p class="caption">
Figure 1.6: Path Diagram of Regression
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lavaan)
Income.sem.m2 &lt;-<span class="st"> &#39;</span>
<span class="st">  # Regressions</span>
<span class="st">    Income ~ gamma1 * Value + gamma2 * Education +</span>
<span class="st">             gamma3 * Age   + gamma4 * MortgagePayment</span>

<span class="st">  # Variances and Covariances</span>
<span class="st">    Value     ~~ r12 * Education</span>
<span class="st">    Value     ~~ r13 * Age</span>
<span class="st">    Value     ~~ r14 * MortgagePayment</span>
<span class="st">    Education ~~ r23 * Age</span>
<span class="st">    Education ~~ r24 * MortgagePayment</span>
<span class="st">    Age       ~~ r34 * MortgagePayment</span>
<span class="st">    Income    ~~ sigma2I * Income</span>
<span class="st">&#39;</span>

Income.sem.fm2 &lt;-
<span class="st">  </span>lavaan<span class="op">::</span><span class="kw">sem</span>(
      <span class="dt">model            =</span> Income.sem.m2
    , <span class="dt">data             =</span> Income
    , <span class="dt">ordered          =</span> <span class="ot">NULL</span>
    , <span class="dt">sampling.weights =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.cov       =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.mean      =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.nobs      =</span> <span class="ot">NULL</span>
    , <span class="dt">group            =</span> <span class="ot">NULL</span>
    , <span class="dt">cluster          =</span> <span class="ot">NULL</span>
  <span class="co"># , constraints      = &quot;&quot;</span>
    , <span class="dt">WLS.V            =</span> <span class="ot">NULL</span>
    , <span class="dt">NACOV            =</span> <span class="ot">NULL</span>
  <span class="co"># ,   ...</span>
  )

<span class="co"># anova(Income.sem.fm2)</span>
<span class="co"># coef(Income.sem.fm2)</span>
<span class="kw">parameterEstimates</span>(Income.sem.fm2, <span class="dt">standardized =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>               lhs op             rhs   label       est       se
1           Income  ~           Value  gamma1     0.032    0.005
2           Income  ~       Education  gamma2     0.608    0.248
3           Income  ~             Age  gamma3    -0.037    0.032
4           Income  ~ MortgagePayment  gamma4    -0.001    0.001
5            Value ~~       Education     r12    -2.619    3.799
6            Value ~~             Age     r13    30.408   29.973
7            Value ~~ MortgagePayment     r14  1087.181  616.102
8        Education ~~             Age     r23     2.216    0.840
9        Education ~~ MortgagePayment     r24   -14.822   14.331
10             Age ~~ MortgagePayment     r34   -18.584  109.425
11          Income ~~          Income sigma2I     0.375    0.106
12           Value ~~           Value           773.526  218.786
13       Education ~~       Education             0.458    0.129
14             Age ~~             Age            27.840    7.874
15 MortgagePayment ~~ MortgagePayment         10739.898 3037.702
        z pvalue ci.lower  ci.upper    std.lv std.all std.nox
1   6.323  0.000    0.022     0.042     0.032   0.872   0.872
2   2.446  0.014    0.121     1.095     0.608   0.399   0.399
3  -1.163  0.245   -0.100     0.026    -0.037  -0.191  -0.191
4  -1.038  0.299   -0.004     0.001    -0.001  -0.135  -0.135
5  -0.689  0.491  -10.065     4.827    -2.619  -0.139  -0.139
6   1.015  0.310  -28.338    89.154    30.408   0.207   0.207
7   1.765  0.078 -120.358  2294.719  1087.181   0.377   0.377
8   2.637  0.008    0.569     3.863     2.216   0.621   0.621
9  -1.034  0.301  -42.910    13.265   -14.822  -0.211  -0.211
10 -0.170  0.865 -233.052   195.884   -18.584  -0.034  -0.034
11  3.536  0.000    0.167     0.583     0.375   0.354   0.354
12  3.536  0.000  344.713  1202.340   773.526   1.000   1.000
13  3.536  0.000    0.204     0.711     0.458   1.000   1.000
14  3.536  0.000   12.407    43.273    27.840   1.000   1.000
15  3.536  0.000 4786.112 16693.684 10739.898   1.000   1.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fitmeasures(Income.sem.fm2)</span>
<span class="kw">fitted</span>(Income.sem.fm2)<span class="op">$</span>cov</code></pre>
<pre><code>                Income    Value     Eductn    Age
Income              1.061
Value              20.800   773.526
Education           0.131    -2.619     0.458
Age                 1.318    30.408     2.216    27.840
MortgagePayment    12.351  1087.181   -14.822   -18.584
                MrtggP
Income
Value
Education
Age
MortgagePayment 10739.898</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># residuals(Income.sem.fm2, type = &quot;cor&quot;)</span>
<span class="co"># modificationIndices(Income.sem.fm2)</span>
<span class="kw">var</span>(Income)</code></pre>
<pre><code>                   Income       Value   Education        Age
Income           1.105433   21.667000   0.1365000   1.373333
Value           21.667000  805.756667  -2.7283333  31.675000
Education        0.136500   -2.728333   0.4766667   2.308333
Age              1.373333   31.675000   2.3083333  29.000000
MortgagePayment 12.865667 1132.480000 -15.4400000 -19.358333
                MortgagePayment
Income                 12.86567
Value                1132.48000
Education             -15.44000
Age                   -19.35833
MortgagePayment     11187.39333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Income)</code></pre>
<pre><code>                   Income      Value  Education         Age
Income          1.0000000  0.7259899  0.1880438  0.24255525
Value           0.7259899  1.0000000 -0.1392157  0.20721237
Education       0.1880438 -0.1392157  1.0000000  0.62085779
Age             0.2425553  0.2072124  0.6208578  1.00000000
MortgagePayment 0.1156915  0.3771934 -0.2114343 -0.03398635
                MortgagePayment
Income               0.11569153
Value                0.37719344
Education           -0.21143430
Age                 -0.03398635
MortgagePayment      1.00000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># vcov(Income.sem.fm2)</span>



<span class="kw">summary</span>(
    <span class="dt">object       =</span> Income.sem.fm2
  , <span class="dt">header       =</span> <span class="ot">TRUE</span>
  , <span class="dt">fit.measures =</span> <span class="ot">TRUE</span>
  , <span class="dt">estimates    =</span> <span class="ot">TRUE</span>
  , <span class="dt">ci           =</span> <span class="ot">FALSE</span>
  , <span class="dt">fmi          =</span> <span class="ot">FALSE</span>
  , <span class="dt">standardized =</span> <span class="ot">TRUE</span>
  , <span class="dt">rsquare      =</span> <span class="ot">TRUE</span>
  , <span class="dt">std.nox      =</span> <span class="ot">FALSE</span>
  , <span class="dt">modindices   =</span> <span class="ot">FALSE</span>
  , <span class="dt">nd           =</span> 3L
)</code></pre>
<pre><code>lavaan 0.6-3 ended normally after 114 iterations

  Optimization method                           NLMINB
  Number of free parameters                         15

  Number of observations                            25

  Estimator                                         ML
  Model Fit Test Statistic                       0.000
  Degrees of freedom                                 0
  Minimum Function Value               0.0000000000000

Model test baseline model:

  Minimum Function Test Statistic               47.107
  Degrees of freedom                                10
  P-value                                        0.000

User model versus baseline model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -385.524
  Loglikelihood unrestricted model (H1)       -385.524

  Number of free parameters                         15
  Akaike (AIC)                                 801.048
  Bayesian (BIC)                               819.331
  Sample-size adjusted Bayesian (BIC)          772.815

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent Confidence Interval          0.000  0.000
  P-value RMSEA &lt;= 0.05                             NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000

Parameter Estimates:

  Information                                 Expected
  Information saturated (h1) model          Structured
  Standard Errors                             Standard

Regressions:
                   Estimate   Std.Err  z-value  P(&gt;|z|)
  Income ~
    Value   (gmm1)     0.032    0.005    6.323    0.000
    Educatn (gmm2)     0.608    0.248    2.446    0.014
    Age     (gmm3)    -0.037    0.032   -1.163    0.245
    MrtggPy (gmm4)    -0.001    0.001   -1.038    0.299
   Std.lv   Std.all

     0.032    0.872
     0.608    0.399
    -0.037   -0.191
    -0.001   -0.135

Covariances:
                   Estimate   Std.Err  z-value  P(&gt;|z|)
  Value ~~
    Educatin (r12)    -2.619    3.799   -0.689    0.491
    Age      (r13)    30.408   29.973    1.015    0.310
    MrtggPym (r14)  1087.181  616.102    1.765    0.078
  Education ~~
    Age      (r23)     2.216    0.840    2.637    0.008
    MrtggPym (r24)   -14.822   14.331   -1.034    0.301
  Age ~~
    MrtggPym (r34)   -18.584  109.425   -0.170    0.865
   Std.lv   Std.all

    -2.619   -0.139
    30.408    0.207
  1087.181    0.377

     2.216    0.621
   -14.822   -0.211

   -18.584   -0.034

Variances:
                   Estimate   Std.Err  z-value  P(&gt;|z|)
   .Income  (sg2I)     0.375    0.106    3.536    0.000
    Value            773.526  218.786    3.536    0.000
    Educatn            0.458    0.129    3.536    0.000
    Age               27.840    7.874    3.536    0.000
    MrtggPy        10739.898 3037.702    3.536    0.000
   Std.lv   Std.all
     0.375    0.354
   773.526    1.000
     0.458    1.000
    27.840    1.000
 10739.898    1.000

R-Square:
                   Estimate
    Income             0.646</code></pre>
<div class="figure" style="text-align: center"><span id="fig:Reg2Values"></span>
<img src="images/Reg2Values.png" alt="Path Diagram of Regression with estimates of coefficient" width="80%" />
<p class="caption">
Figure 1.7: Path Diagram of Regression with estimates of coefficient
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="MLM.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SEMwithR.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
