<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Factor Analysis | Structural Equation Modeling with Latent Variables using R</title>
  <meta name="description" content="4 Factor Analysis | Structural Equation Modeling with Latent Variables using R" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="4 Factor Analysis | Structural Equation Modeling with Latent Variables using R" />
  <meta property="og:type" content="book" />





  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Factor Analysis | Structural Equation Modeling with Latent Variables using R" />




<meta name="author" content="Muhammad Yaseen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />


<link rel="prev" href="SEMO.html">
<link rel="next" href="SEM.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="LM.html"><a href="LM.html"><i class="fa fa-check"></i><b>1</b> Linear Model</a><ul>
<li class="chapter" data-level="1.1" data-path="LM.html"><a href="LM.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="LM.html"><a href="LM.html#linear-modeling-approach"><i class="fa fa-check"></i><b>1.2</b> Linear Modeling Approach</a></li>
<li class="chapter" data-level="1.3" data-path="LM.html"><a href="LM.html#strucural-equation-modeling-approach"><i class="fa fa-check"></i><b>1.3</b> Strucural Equation Modeling Approach</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="MLM.html"><a href="MLM.html"><i class="fa fa-check"></i><b>2</b> Multivariate Linear Model</a><ul>
<li class="chapter" data-level="2.1" data-path="MLM.html"><a href="MLM.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SEMO.html"><a href="SEMO.html"><i class="fa fa-check"></i><b>3</b> Structural Equation Modeling with Observed Variables</a><ul>
<li class="chapter" data-level="3.1" data-path="SEMO.html"><a href="SEMO.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="FA.html"><a href="FA.html"><i class="fa fa-check"></i><b>4</b> Factor Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="FA.html"><a href="FA.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="SEM.html"><a href="SEM.html"><i class="fa fa-check"></i><b>5</b> Strucural Equation Modeling with Latent Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="SEM.html"><a href="SEM.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/baydap/bookdownplus/" target="blank">Supported by bookdownplus</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Equation Modeling with Latent Variables using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="FA" class="section level1">
<h1><span class="header-section-number">4</span> Factor Analysis</h1>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>The general model for confirmatory factor analysis is</p>
<p><span class="math display">\[\begin{align}
\mathbf{y}_{i} &amp; =\bm{\Lambda}_{y}\bm{\eta}_{i}+\bm{\epsilon}_{i}\label{eq:MeasurementModel1}\\
\mathbf{x}_{i} &amp; =\bm{\Lambda}_{x}\bm{\xi}_{i}+\bm{\delta}_{i}\label{eq:MeasurementModel2}
\end{align}\]</span></p>
<p>The <span class="math inline">\(\mathbf{y}_{i}\)</span> <span class="math inline">\(\left(p\times1\right)\)</span> and the <span class="math inline">\(\mathbf{x}_{i}\)</span>
<span class="math inline">\(\left(q\times1\right)\)</span> vectors are observed variables, <span class="math inline">\(\bm{\Lambda}_{y}\)</span>
<span class="math inline">\(\left(p\times m\right)\)</span> (Lambda) and <span class="math inline">\(\bm{\Lambda}_{x}\)</span> <span class="math inline">\(\left(q\times n\right)\)</span>
are the coefficient matrices that show the relation of <span class="math inline">\(\mathbf{y}_{i}\)</span>
to <span class="math inline">\(\bm{\eta}_{i}\)</span> and <span class="math inline">\(\mathbf{x}_{i}\)</span> to <span class="math inline">\(\bm{\xi}_{i}\)</span> respectively,
and <span class="math inline">\(\bm{\epsilon}_{i}\)</span> <span class="math inline">\(\left(p\times1\right)\)</span> (epsilon) and <span class="math inline">\(\bm{\delta}_{i}\)</span>
<span class="math inline">\(\left(q\times1\right)\)</span> (delta) are the errors of measurement for
<span class="math inline">\(\mathbf{y}_{i}\)</span> and <span class="math inline">\(\mathbf{x}_{i}\)</span>, respectively. The errors
of measurement are assumed to be uncorrelated with <span class="math inline">\(\bm{\eta}_{i}\)</span> and
<span class="math inline">\(\bm{\xi}_{i}\)</span> and with each other.</p>

<div class="figure" style="text-align: center"><span id="fig:Science1"></span>
<img src="images/Science1.png" alt="Path Diagram for Aptitude" width="80%" />
<p class="caption">
Figure 4.1: Path Diagram for Aptitude
</p>
</div>

<div class="figure" style="text-align: center"><span id="fig:HSF1"></span>
<img src="images/HSF1.png" alt="Path Diagram for Holzinger and Swineford (1939)" width="80%" />
<p class="caption">
Figure 4.2: Path Diagram for Holzinger and Swineford (1939)
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lavaan)

<span class="kw">load</span>(<span class="st">&quot;HSF.RData&quot;</span>)
<span class="co"># HSF</span>
<span class="kw">str</span>(HSF)</code></pre>
<pre><code>&#39;data.frame&#39;:   73 obs. of  6 variables:
 $ VisualPerc: num  33 30 36 28 30 20 17 33 30 36 ...
 $ Cubes     : num  22 25 33 25 25 25 21 31 22 28 ...
 $ Lozenges  : num  17 20 36 9 11 6 6 30 20 22 ...
 $ Paragrap  : num  8 10 17 10 11 9 5 11 8 13 ...
 $ Sentence  : num  17 23 25 18 21 21 10 23 17 24 ...
 $ WordMean  : num  10 18 41 11 8 16 10 18 20 36 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">HSF.sem.m1 &lt;-<span class="st"> &#39;</span>
<span class="st">  # Latent Variables</span>
<span class="st">    Spatial =~ lambda1 * VisualPerc + lambda2 * Cubes +</span>
<span class="st">               lambda3 * Lozenges</span>
<span class="st">    Verbal  =~ lambda4 * Paragrap + lambda5 * Sentence +</span>
<span class="st">               lambda6 * WordMean</span>

<span class="st">  # Variances and Covariances</span>
<span class="st">    Spatial  ~~ r12 * Verbal</span>
<span class="st">&#39;</span>

HSF.sem.fm1 &lt;-
<span class="st">  </span>lavaan<span class="op">::</span><span class="kw">sem</span>(
      <span class="dt">model            =</span> HSF.sem.m1
    , <span class="dt">data             =</span> HSF
    , <span class="dt">ordered          =</span> <span class="ot">NULL</span>
    , <span class="dt">sampling.weights =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.cov       =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.mean      =</span> <span class="ot">NULL</span>
    , <span class="dt">sample.nobs      =</span> <span class="ot">NULL</span>
    , <span class="dt">group            =</span> <span class="ot">NULL</span>
    , <span class="dt">cluster          =</span> <span class="ot">NULL</span>
  <span class="co"># , constraints      = &quot;&quot;</span>
    , <span class="dt">WLS.V            =</span> <span class="ot">NULL</span>
    , <span class="dt">NACOV            =</span> <span class="ot">NULL</span>
  <span class="co"># ,   ...</span>
  )

<span class="co"># methods(class = class(HSF.sem.fm1))</span>
<span class="co"># anova(HSF.sem.fm1)</span>
<span class="co"># coef(HSF.sem.fm1)</span>
<span class="kw">parameterEstimates</span>(HSF.sem.fm1, <span class="dt">standardized =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>          lhs op        rhs   label    est    se     z pvalue
1     Spatial =~ VisualPerc lambda1  1.000 0.000    NA     NA
2     Spatial =~      Cubes lambda2  0.610 0.142 4.279  0.000
3     Spatial =~   Lozenges lambda3  1.198 0.270 4.436  0.000
4      Verbal =~   Paragrap lambda4  1.000 0.000    NA     NA
5      Verbal =~   Sentence lambda5  1.334 0.159 8.379  0.000
6      Verbal =~   WordMean lambda6  2.234 0.262 8.541  0.000
7     Spatial ~~     Verbal     r12  7.315 2.553 2.865  0.004
8  VisualPerc ~~ VisualPerc         23.873 5.945 4.016  0.000
9       Cubes ~~      Cubes         11.602 2.566 4.521  0.000
10   Lozenges ~~   Lozenges         28.275 7.837 3.608  0.000
11   Paragrap ~~   Paragrap          2.834 0.863 3.286  0.001
12   Sentence ~~   Sentence          7.967 1.856 4.292  0.000
13   WordMean ~~   WordMean         19.925 4.917 4.052  0.000
14    Spatial ~~    Spatial         23.302 8.068 2.888  0.004
15     Verbal ~~     Verbal          9.682 2.144 4.516  0.000
   ci.lower ci.upper std.lv std.all std.nox
1     1.000    1.000  4.827   0.703   0.703
2     0.330    0.889  2.943   0.654   0.654
3     0.669    1.728  5.784   0.736   0.736
4     1.000    1.000  3.112   0.880   0.880
5     1.022    1.646  4.151   0.827   0.827
6     1.722    2.747  6.952   0.841   0.841
7     2.311   12.319  0.487   0.487   0.487
8    12.221   35.525 23.873   0.506   0.506
9     6.572   16.631 11.602   0.572   0.572
10   12.914   43.636 28.275   0.458   0.458
11    1.143    4.524  2.834   0.226   0.226
12    4.329   11.605  7.967   0.316   0.316
13   10.288   29.563 19.925   0.292   0.292
14    7.490   39.114  1.000   1.000   1.000
15    5.481   13.884  1.000   1.000   1.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fitmeasures(HSF.sem.fm1)</span>
<span class="kw">fitted</span>(HSF.sem.fm1)<span class="op">$</span>cov</code></pre>
<pre><code>           VslPrc Cubes  Lozngs Pargrp Sentnc WordMn
VisualPerc 47.175
Cubes      14.209 20.265
Lozenges   27.919 17.024 61.726
Paragrap    7.315  4.461  8.765 12.516
Sentence    9.759  5.950 11.692 12.916 25.197
WordMean   16.344  9.966 19.583 21.633 28.859 68.260</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># residuals(HSF.sem.fm1, type = &quot;cor&quot;)</span>
<span class="co"># modificationIndices(HSF.sem.fm1)</span>
<span class="kw">var</span>(HSF)</code></pre>
<pre><code>           VisualPerc     Cubes  Lozenges  Paragrap  Sentence
VisualPerc  47.829909 15.137938 26.899734  8.450723 12.820396
Cubes       15.137938 20.546804 17.658105  3.402207  4.092085
Lozenges    26.899734 17.658105 62.583714  9.181507 13.411339
Paragrap     8.450723  3.402207  9.181507 12.689878 13.042237
Sentence    12.820396  4.092085 13.411339 13.042237 25.546804
WordMean    13.217846  6.934741 24.280061 22.019597 29.245814
            WordMean
VisualPerc 13.217846
Cubes       6.934741
Lozenges   24.280061
Paragrap   22.019597
Sentence   29.245814
WordMean   69.208143</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># vcov(HSF.sem.fm1)</span>


<span class="kw">summary</span>(
    <span class="dt">object       =</span> HSF.sem.fm1
  , <span class="dt">header       =</span> <span class="ot">TRUE</span>
  , <span class="dt">fit.measures =</span> <span class="ot">FALSE</span>
  , <span class="dt">estimates    =</span> <span class="ot">TRUE</span>
  , <span class="dt">ci           =</span> <span class="ot">FALSE</span>
  , <span class="dt">fmi          =</span> <span class="ot">FALSE</span>
  , <span class="dt">standardized =</span> <span class="ot">TRUE</span>
  , <span class="dt">rsquare      =</span> <span class="ot">TRUE</span>
  , <span class="dt">std.nox      =</span> <span class="ot">FALSE</span>
  , <span class="dt">modindices   =</span> <span class="ot">FALSE</span>
  , <span class="dt">nd           =</span> 3L
)</code></pre>
<pre><code>lavaan 0.6-3 ended normally after 64 iterations

  Optimization method                           NLMINB
  Number of free parameters                         13

  Number of observations                            73

  Estimator                                         ML
  Model Fit Test Statistic                       7.962
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.437

Parameter Estimates:

  Information                                 Expected
  Information saturated (h1) model          Structured
  Standard Errors                             Standard

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  Spatial =~
    VislPrc (lmb1)    1.000                               4.827
    Cubes   (lmb2)    0.610    0.142    4.279    0.000    2.943
    Lozengs (lmb3)    1.198    0.270    4.436    0.000    5.784
  Verbal =~
    Paragrp (lmb4)    1.000                               3.112
    Sentenc (lmb5)    1.334    0.159    8.379    0.000    4.151
    WordMen (lmb6)    2.234    0.262    8.541    0.000    6.952
  Std.all

    0.703
    0.654
    0.736

    0.880
    0.827
    0.841

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  Spatial ~~
    Verbal   (r12)    7.315    2.553    2.865    0.004    0.487
  Std.all

    0.487

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
   .VisualPerc       23.873    5.945    4.016    0.000   23.873
   .Cubes            11.602    2.566    4.521    0.000   11.602
   .Lozenges         28.275    7.837    3.608    0.000   28.275
   .Paragrap          2.834    0.863    3.286    0.001    2.834
   .Sentence          7.967    1.856    4.292    0.000    7.967
   .WordMean         19.925    4.917    4.052    0.000   19.925
    Spatial          23.302    8.068    2.888    0.004    1.000
    Verbal            9.682    2.144    4.516    0.000    1.000
  Std.all
    0.506
    0.572
    0.458
    0.226
    0.316
    0.292
    1.000
    1.000

R-Square:
                   Estimate
    VisualPerc        0.494
    Cubes             0.428
    Lozenges          0.542
    Paragrap          0.774
    Sentence          0.684
    WordMean          0.708</code></pre>
<div class="figure" style="text-align: center"><span id="fig:HSF1Values"></span>
<img src="images/HSF1Values.png" alt="Path Diagram with estimates of coefficients" width="80%" />
<p class="caption">
Figure 4.3: Path Diagram with estimates of coefficients
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SEMO.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SEM.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SEMwithR.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
